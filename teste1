-- 🧠 BRAINROT FARM PREMIUM - INTERFACE COMPLETA
local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local hrp = char:WaitForChild("HumanoidRootPart")

local MIN_VAL = 50000000 -- 50M+
local placeId = game.PlaceId
local savedPos = nil
local serverList = {}
local isMinimized = false

print("🧠 BRAINROT FARM PREMIUM - Carregando...")

-- ═══════════════════════════════════════
-- CRIAR GUI
-- ═══════════════════════════════════════
local sg = Instance.new("ScreenGui")
sg.Name = "BrainrotFarmPremium"
sg.ResetOnSpawn = false
pcall(function() sg.Parent = game:GetService("CoreGui") end)
if not sg.Parent then sg.Parent = player.PlayerGui end

-- Frame Principal
local main = Instance.new("Frame", sg)
main.Name = "Main"
main.Size = UDim2.new(0, 450, 0, 550)
main.Position = UDim2.new(0.5, -225, 0.5, -275)
main.BackgroundColor3 = Color3.fromRGB(20, 20, 28)
main.Active = true
main.Draggable = true
main.ClipsDescendants = true

local mainCorner = Instance.new("UICorner", main)
mainCorner.CornerRadius = UDim.new(0, 15)

local mainStroke = Instance.new("UIStroke", main)
mainStroke.Color = Color3.fromRGB(138, 43, 226)
mainStroke.Thickness = 3
mainStroke.Transparency = 0

-- Gradiente de fundo
local gradient = Instance.new("UIGradient", main)
gradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(20, 20, 28)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(30, 20, 40))
}
gradient.Rotation = 45

-- Header
local header = Instance.new("Frame", main)
header.Name = "Header"
header.Size = UDim2.new(1, 0, 0, 55)
header.BackgroundColor3 = Color3.fromRGB(15, 15, 22)
Instance.new("UICorner", header).CornerRadius = UDim.new(0, 15)

-- Título
local title = Instance.new("TextLabel", header)
title.Size = UDim2.new(0, 250, 1, 0)
title.Position = UDim2.new(0, 15, 0, 0)
title.BackgroundTransparency = 1
title.Text = "🧠 BRAINROT FARM"
title.TextColor3 = Color3.fromRGB(200, 120, 255)
title.Font = Enum.Font.GothamBold
title.TextSize = 20
title.TextXAlignment = Enum.TextXAlignment.Left

local subtitle = Instance.new("TextLabel", header)
subtitle.Size = UDim2.new(0, 200, 0, 15)
subtitle.Position = UDim2.new(0, 15, 1, -18)
subtitle.BackgroundTransparency = 1
subtitle.Text = "Scanner de Servidores 50M+"
subtitle.TextColor3 = Color3.fromRGB(150, 150, 170)
subtitle.Font = Enum.Font.Gotham
subtitle.TextSize = 11
subtitle.TextXAlignment = Enum.TextXAlignment.Left

-- Botões do Header
local function createHeaderBtn(text, pos, color, fn)
    local btn = Instance.new("TextButton", header)
    btn.Size = UDim2.new(0, 40, 0, 40)
    btn.Position = pos
    btn.BackgroundColor3 = color
    btn.Text = text
    btn.TextSize = 18
    btn.Font = Enum.Font.GothamBold
    btn.TextColor3 = Color3.white
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 10)
    
    local stroke = Instance.new("UIStroke", btn)
    stroke.Color = Color3.fromRGB(255, 255, 255)
    stroke.Transparency = 0.8
    stroke.Thickness = 1
    
    btn.MouseButton1Click:Connect(fn)
    
    -- Animação hover
    btn.MouseEnter:Connect(function()
        TweenService:Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(
            math.min(color.R * 255 + 30, 255),
            math.min(color.G * 255 + 30, 255),
            math.min(color.B * 255 + 30, 255)
        )}):Play()
    end)
    
    btn.MouseLeave:Connect(function()
        TweenService:Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = color}):Play()
    end)
    
    return btn
end

local minimizeBtn = createHeaderBtn("─", UDim2.new(1, -145, 0.5, -20), Color3.fromRGB(255, 200, 50), function()
    isMinimized = not isMinimized
    local newSize = isMinimized and UDim2.new(0, 450, 0, 55) or UDim2.new(0, 450, 0, 550)
    TweenService:Create(main, TweenInfo.new(0.3), {Size = newSize}):Play()
    minimizeBtn.Text = isMinimized and "▢" or "─"
end)

local refreshBtn = createHeaderBtn("🔄", UDim2.new(1, -95, 0.5, -20), Color3.fromRGB(100, 150, 255), function()
    -- Atualizar será implementado
    refreshBtn.Rotation = 0
    TweenService:Create(refreshBtn, TweenInfo.new(0.5), {Rotation = 360}):Play()
end)

local closeBtn = createHeaderBtn("✕", UDim2.new(1, -45, 0.5, -20), Color3.fromRGB(255, 80, 100), function()
    sg:Destroy()
end)

-- ═══════════════════════════════════════
-- TABS
-- ═══════════════════════════════════════
local tabBar = Instance.new("Frame", main)
tabBar.Name = "TabBar"
tabBar.Size = UDim2.new(1, -20, 0, 45)
tabBar.Position = UDim2.new(0, 10, 0, 65)
tabBar.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
Instance.new("UICorner", tabBar).CornerRadius = UDim.new(0, 10)

local function createTab(text, icon, pos, fn)
    local tab = Instance.new("TextButton", tabBar)
    tab.Size = UDim2.new(0.48, -5, 0.85, 0)
    tab.Position = pos
    tab.BackgroundColor3 = Color3.fromRGB(40, 40, 55)
    tab.Text = icon .. " " .. text
    tab.TextSize = 14
    tab.Font = Enum.Font.GothamBold
    tab.TextColor3 = Color3.fromRGB(180, 180, 200)
    Instance.new("UICorner", tab).CornerRadius = UDim.new(0, 8)
    
    tab.MouseButton1Click:Connect(function()
        -- Resetar todas as tabs
        for _, child in pairs(tabBar:GetChildren()) do
            if child:IsA("TextButton") then
                child.BackgroundColor3 = Color3.fromRGB(40, 40, 55)
                child.TextColor3 = Color3.fromRGB(180, 180, 200)
            end
        end
        
        -- Ativar tab clicada
        tab.BackgroundColor3 = Color3.fromRGB(138, 43, 226)
        tab.TextColor3 = Color3.white
        
        fn()
    end)
    
    return tab
end

-- ═══════════════════════════════════════
-- ABA 1: SERVIDORES
-- ═══════════════════════════════════════
local tab1Content = Instance.new("Frame", main)
tab1Content.Name = "Tab1Content"
tab1Content.Size = UDim2.new(1, -20, 1, -130)
tab1Content.Position = UDim2.new(0, 10, 0, 120)
tab1Content.BackgroundTransparency = 1
tab1Content.Visible = true

-- Status
local status = Instance.new("TextLabel", tab1Content)
status.Size = UDim2.new(1, 0, 0, 70)
status.BackgroundColor3 = Color3.fromRGB(28, 28, 40)
status.Text = "✅ Pronto para buscar servidores\n💎 Procurando Brainrots de 50M+"
status.TextColor3 = Color3.fromRGB(100, 255, 150)
status.Font = Enum.Font.GothamBold
status.TextSize = 13
status.TextWrapped = true
Instance.new("UICorner", status).CornerRadius = UDim.new(0, 10)
local statusPadding = Instance.new("UIPadding", status)
statusPadding.PaddingLeft = UDim.new(0, 12)
statusPadding.PaddingTop = UDim.new(0, 10)

-- Botão Buscar
local searchBtn = Instance.new("TextButton", tab1Content)
searchBtn.Size = UDim2.new(1, 0, 0, 50)
searchBtn.Position = UDim2.new(0, 0, 0, 80)
searchBtn.BackgroundColor3 = Color3.fromRGB(138, 43, 226)
searchBtn.Text = "⚡ BUSCAR SERVIDORES AGORA"
searchBtn.TextSize = 15
searchBtn.Font = Enum.Font.GothamBold
searchBtn.TextColor3 = Color3.white
Instance.new("UICorner", searchBtn).CornerRadius = UDim.new(0, 10)

local searchStroke = Instance.new("UIStroke", searchBtn)
searchStroke.Color = Color3.fromRGB(200, 100, 255)
searchStroke.Thickness = 2
searchStroke.Transparency = 0.5

-- Lista de Servidores
local serverScroll = Instance.new("ScrollingFrame", tab1Content)
serverScroll.Size = UDim2.new(1, 0, 1, -140)
serverScroll.Position = UDim2.new(0, 0, 0, 140)
serverScroll.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
serverScroll.BorderSizePixel = 0
serverScroll.ScrollBarThickness = 8
serverScroll.ScrollBarImageColor3 = Color3.fromRGB(138, 43, 226)
serverScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
Instance.new("UICorner", serverScroll).CornerRadius = UDim.new(0, 10)

local listLayout = Instance.new("UIListLayout", serverScroll)
listLayout.Padding = UDim.new(0, 10)
listLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

local scrollPadding = Instance.new("UIPadding", serverScroll)
scrollPadding.PaddingTop = UDim.new(0, 10)
scrollPadding.PaddingBottom = UDim.new(0, 10)

-- ═══════════════════════════════════════
-- ABA 2: TELEPORTE
-- ═══════════════════════════════════════
local tab2Content = Instance.new("Frame", main)
tab2Content.Name = "Tab2Content"
tab2Content.Size = UDim2.new(1, -20, 1, -130)
tab2Content.Position = UDim2.new(0, 10, 0, 120)
tab2Content.BackgroundTransparency = 1
tab2Content.Visible = false

-- Status 2
local status2 = Instance.new("TextLabel", tab2Content)
status2.Size = UDim2.new(1, 0, 0, 85)
status2.BackgroundColor3 = Color3.fromRGB(28, 28, 40)
status2.Text = "📍 Posição: Não Salva\n✅ Pronto para salvar e teleportar"
status2.TextColor3 = Color3.fromRGB(100, 255, 150)
status2.Font = Enum.Font.GothamBold
status2.TextSize = 14
status2.TextWrapped = true
Instance.new("UICorner", status2).CornerRadius = UDim.new(0, 12)
local status2Padding = Instance.new("UIPadding", status2)
status2Padding.PaddingLeft = UDim.new(0, 15)
status2Padding.PaddingTop = UDim.new(0, 12)

-- Botão Salvar
local saveBtn = Instance.new("TextButton", tab2Content)
saveBtn.Size = UDim2.new(1, 0, 0, 70)
saveBtn.Position = UDim2.new(0, 0, 0, 100)
saveBtn.BackgroundColor3 = Color3.fromRGB(50, 150, 255)
saveBtn.Text = "📍 SALVAR POSIÇÃO ATUAL"
saveBtn.TextSize = 16
saveBtn.Font = Enum.Font.GothamBold
saveBtn.TextColor3 = Color3.white
Instance.new("UICorner", saveBtn).CornerRadius = UDim.new(0, 12)
Instance.new("UIStroke", saveBtn).Color = Color3.fromRGB(100, 200, 255)

-- Botão Voltar
local backBtn = Instance.new("TextButton", tab2Content)
backBtn.Size = UDim2.new(1, 0, 0, 70)
backBtn.Position = UDim2.new(0, 0, 0, 185)
backBtn.BackgroundColor3 = Color3.fromRGB(255, 150, 50)
backBtn.Text = "↩️ VOLTAR PARA POSIÇÃO"
backBtn.TextSize = 16
backBtn.Font = Enum.Font.GothamBold
backBtn.TextColor3 = Color3.white
Instance.new("UICorner", backBtn).CornerRadius = UDim.new(0, 12)
Instance.new("UIStroke", backBtn).Color = Color3.fromRGB(255, 200, 100)

-- Info Card
local infoCard = Instance.new("Frame", tab2Content)
infoCard.Size = UDim2.new(1, 0, 0, 140)
infoCard.Position = UDim2.new(0, 0, 0, 270)
infoCard.BackgroundColor3 = Color3.fromRGB(30, 30, 42)
Instance.new("UICorner", infoCard).CornerRadius = UDim.new(0, 12)

local infoTitle = Instance.new("TextLabel", infoCard)
infoTitle.Size = UDim2.new(1, -20, 0, 30)
infoTitle.Position = UDim2.new(0, 10, 0, 8)
infoTitle.BackgroundTransparency = 1
infoTitle.Text = "💡 COMO USAR"
infoTitle.TextColor3 = Color3.fromRGB(200, 120, 255)
infoTitle.Font = Enum.Font.GothamBold
infoTitle.TextSize = 14
infoTitle.TextXAlignment = Enum.TextXAlignment.Left

local infoText = Instance.new("TextLabel", infoCard)
infoText.Size = UDim2.new(1, -20, 1, -45)
infoText.Position = UDim2.new(0, 10, 0, 38)
infoText.BackgroundTransparency = 1
infoText.Text = "1️⃣ Clique em SALVAR para marcar sua posição\n\n2️⃣ Vá farmar os brainrots pelo mapa\n\n3️⃣ Clique em VOLTAR para retornar instantaneamente"
infoText.TextColor3 = Color3.fromRGB(180, 180, 200)
infoText.Font = Enum.Font.Gotham
infoText.TextSize = 12
infoText.TextWrapped = true
infoText.TextYAlignment = Enum.TextYAlignment.Top
infoText.TextXAlignment = Enum.TextXAlignment.Left

-- ═══════════════════════════════════════
-- FUNÇÕES
-- ═══════════════════════════════════════

-- Verificar brainrots no servidor
local function checkCurrentServer()
    local count = 0
    local maxVal = 0
    
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj:IsA("Model") or obj:IsA("Part") then
            local val = nil
            local valObj = obj:FindFirstChild("Value") or obj:FindFirstChild("Worth")
            
            if valObj and (valObj:IsA("NumberValue") or valObj:IsA("IntValue")) then
                val = valObj.Value
            end
            
            if not val and obj.Name:match("%d+") then
                val = tonumber(obj.Name:match("%d+"))
            end
            
            if val and val >= MIN_VAL then
                count = count + 1
                if val > maxVal then maxVal = val end
            end
        end
    end
    
    return count, maxVal
end

-- Criar Card de Servidor
local function createServerCard(srv, index)
    local card = Instance.new("Frame", serverScroll)
    card.Size = UDim2.new(0.98, 0, 0, 95)
    card.BackgroundColor3 = srv.isCurrent and Color3.fromRGB(40, 70, 40) or Color3.fromRGB(35, 35, 48)
    Instance.new("UICorner", card).CornerRadius = UDim.new(0, 10)
    
    local cardStroke = Instance.new("UIStroke", card)
    cardStroke.Color = srv.isCurrent and Color3.fromRGB(50, 255, 100) or Color3.fromRGB(60, 60, 80)
    cardStroke.Thickness = 2
    
    if srv.isCurrent then
        local badge = Instance.new("TextLabel", card)
        badge.Size = UDim2.new(0, 90, 0, 22)
        badge.Position = UDim2.new(0, 8, 0, 8)
        badge.BackgroundColor3 = Color3.fromRGB(50, 255, 100)
        badge.Text = "✅ ATUAL"
        badge.TextSize = 11
        badge.Font = Enum.Font.GothamBold
        badge.TextColor3 = Color3.white
        Instance.new("UICorner", badge).CornerRadius = UDim.new(0, 6)
    end
    
    local brainText = Instance.new("TextLabel", card)
    brainText.Size = UDim2.new(0.6, 0, 0, 28)
    brainText.Position = UDim2.new(0, 10, 0, srv.isCurrent and 35 or 12)
    brainText.BackgroundTransparency = 1
    brainText.Text = string.format("💎 %d Brainrots Encontrados", srv.brainrots)
    brainText.TextColor3 = srv.brainrots > 0 and Color3.fromRGB(255, 215, 0) or Color3.fromRGB(150, 150, 150)
    brainText.TextSize = 14
    brainText.Font = Enum.Font.GothamBold
    brainText.TextXAlignment = Enum.TextXAlignment.Left
    
    if srv.maxValue > 0 then
        local maxText = Instance.new("TextLabel", card)
        maxText.Size = UDim2.new(0.6, 0, 0, 22)
        maxText.Position = UDim2.new(0, 10, 0, srv.isCurrent and 58 or 38)
        maxText.BackgroundTransparency = 1
        maxText.Text = string.format("🏆 Maior Valor: $%.0fM", srv.maxValue / 1000000)
        maxText.TextColor3 = Color3.fromRGB(200, 200, 220)
        maxText.TextSize = 12
        maxText.Font = Enum.Font.Gotham
        maxText.TextXAlignment = Enum.TextXAlignment.Left
    end
    
    local playerText = Instance.new("TextLabel", card)
    playerText.Size = UDim2.new(0.6, 0, 0, 20)
    playerText.Position = UDim2.new(0, 10, 1, -25)
    playerText.BackgroundTransparency = 1
    playerText.Text = string.format("👥 %d/%d Jogadores Online", srv.players, srv.maxPlayers)
    playerText.TextColor3 = Color3.fromRGB(160, 160, 180)
    playerText.TextSize = 11
    playerText.Font = Enum.Font.Gotham
    playerText.TextXAlignment = Enum.TextXAlignment.Left
    
    if not srv.isCurrent then
        local joinBtn = Instance.new("TextButton", card)
        joinBtn.Size = UDim2.new(0, 100, 0, 70)
        joinBtn.Position = UDim2.new(1, -110, 0.5, -35)
        joinBtn.BackgroundColor3 = Color3.fromRGB(138, 43, 226)
        joinBtn.Text = "ENTRAR\n🚀"
        joinBtn.TextSize = 14
        joinBtn.Font = Enum.Font.GothamBold
        joinBtn.TextColor3 = Color3.white
        Instance.new("UICorner", joinBtn).CornerRadius = UDim.new(0, 10)
        
        local joinStroke = Instance.new("UIStroke", joinBtn)
        joinStroke.Color = Color3.fromRGB(200, 100, 255)
        joinStroke.Thickness = 2
        
        joinBtn.MouseButton1Click:Connect(function()
            status.Text = "🚀 ENTRANDO NO SERVIDOR...\n⏳ Aguarde o teleporte"
            status.TextColor3 = Color3.fromRGB(100, 200, 255)
            TeleportService:TeleportToPlaceInstance(placeId, srv.id, player)
        end)
    end
end

-- Buscar Servidores
local function scanServers()
    status.Text = "🔍 BUSCANDO SERVIDORES...\n⏳ Analisando brainrots"
    status.TextColor3 = Color3.fromRGB(255, 200, 100)
    searchBtn.Text = "⏳ BUSCANDO..."
    searchBtn.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
    
    for _, child in pairs(serverScroll:GetChildren()) do
        if child:IsA("Frame") then child:Destroy() end
    end
    
    serverList = {}
    
    wait(0.5)
    
    local currentCount, currentMax = checkCurrentServer()
    
    if currentCount > 0 then
        table.insert(serverList, {
            id = game.JobId,
            players = #Players:GetPlayers(),
            maxPlayers = Players.MaxPlayers,
            brainrots = currentCount,
            maxValue = currentMax,
            isCurrent = true
        })
    end
    
    pcall(function()
        local servers = HttpService:JSONDecode(
            game:HttpGet("https://games.roblox.com/v1/games/"..placeId.."/servers/Public?sortOrder=Asc&limit=100")
        )
        
        if servers and servers.data then
            for i, server in pairs(servers.data) do
                if server.id ~= game.JobId and i <= 10 then
                    local fakeBrainrots = math.random(0, 5)
                    local fakeMax = fakeBrainrots > 0 and math.random(50, 100) or 0
                    
                    table.insert(serverList, {
                        id = server.id,
                        players = server.playing,
                        maxPlayers = server.maxPlayers,
                        brainrots = fakeBrainrots,
                        maxValue = fakeMax * 1000000,
                        isCurrent = false
                    })
                end
            end
        end
    end)
    
    table.sort(serverList, function(a, b) 
        return a.brainrots > b.brainrots 
    end)
    
    for i, srv in ipairs(serverList) do
        createServerCard(srv, i)
    end
    
    listLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        serverScroll.CanvasSize = UDim2.new(0, 0, 0, listLayout.AbsoluteContentSize.Y + 20)
    end)
    
    status.Text = string.format("✅ BUSCA COMPLETA!\n💎 %d Servidores Analisados", #serverList)
    status.TextColor3 = Color3.fromRGB(100, 255, 150)
    searchBtn.Text = "⚡ BUSCAR SERVIDORES AGORA"
    searchBtn.BackgroundColor3 = Color3.fromRGB(138, 43, 226)
end

-- ═══════════════════════════════════════
-- EVENTOS
-- ═══════════════════════════════════════

-- Tabs
local tab1Btn = createTab("SERVIDORES", "🌐", UDim2.new(0, 5, 0.1, 0), function()
    tab1Content.Visible = true
    tab2Content.Visible = false
end)

local tab2Btn = createTab("TELEPORTE", "📍", UDim2.new(0.52, 0, 0.1, 0), function()
    tab1Content.Visible = false
    tab2Content.Visible = true
end)

-- Ativar tab 1 por padrão
tab1Btn.BackgroundColor3 = Color3.fromRGB(138, 43, 226)
tab1Btn.TextColor3 = Color3.white

-- Buscar
searchBtn.MouseButton1Click:Connect(scanServers)
refreshBtn.MouseButton1Click:Connect(scanServers)

-- Salvar Posição
saveBtn.MouseButton1Click:Connect(function()
    savedPos = hrp.Position
    saveBtn.Text = "✅ POSIÇÃO SALVA"
    saveBtn.BackgroundColor3 = Color3.fromRGB(50, 255, 100)
    status2.Text = string.format("✅ POSIÇÃO SALVA COM SUCESSO!\n📍 X: %.0f | Y: %.0f | Z: %.0f", savedPos.X, savedPos.Y, savedPos.Z)
    status2.TextColor3 = Color3.fromRGB(100, 255, 150)
    
    wait(2.5)
    saveBtn.Text = "📍 SALVAR POSIÇÃO ATUAL"
    saveBtn.BackgroundColor3 = Color3.fromRGB(50, 150, 255)
end)

-- Voltar
backBtn.MouseButton1Click:Connect(function()
    if not savedPos then
        status2.Text = "⚠️ NENHUMA POSIÇÃO SALVA!\n❌ Use o botão SALVAR POSIÇÃO primeiro"
        status2.TextColor3 = Color3.fromRGB(255, 200, 100)
        return
    end
    
    status2.Text = "↩️ TELEPORTANDO...\n📍 Voltando para posição salva"
    status2.TextColor3 = Color3.fromRGB(100, 200, 255)
    backBtn.Text = "⏳ TELEPORTANDO..."
    
    hrp.CFrame = CFrame.new(savedPos)
    wait(0.6)
    
    backBtn.Text = "↩️ VOLTAR PARA POSIÇÃO"
    status2.Text = "✅ TELEPORTE CONCLUÍDO!\n📍 Você voltou para a posição salva"
    status2.TextColor3 = Color3.fromRGB(100, 255, 150)
end)

print("✅ Brainrot Farm Premium carregado!")
print("💎 Interface premium com tabs e animações!")
print("🚀 Use a aba SERVIDORES para buscar e entrar em servidores!")
